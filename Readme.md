
p.s. тестовое задание. токены и тд не требуются
# Web Auth Service

`web_auth` — это сервис для аутентификации пользователей и управления сообщениями, написанный на Go. Сервис предоставляет REST API для регистрации пользователей, аутентификации и работы с сообщениями.

## Оглавление

- [Запуск в Docker](#запуск-в-docker)
    - [Предварительные требования](#предварительные-требования)
    - [Сборка и запуск контейнера](#сборка-и-запуск-контейнера)
- [Конфигурация](#конфигурация)
    - [Переменные окружения](#переменные-окружения)
- [Миграции базы данных](#миграции-базы-данных)
- [Локальная разработка](#локальная-разработка)
- [Наполнение базы данных тестовыми данными](#наполнение-базы-данных-тестовыми-данными)

## Запуск в Docker

### Предварительные требования

Для запуска приложения в Docker у вас должны быть установлены:
- Docker
- PostgreSQL

### Сборка и запуск контейнера

1. Клонируйте репозиторий:

   ```bash
   git clone https://github.com/KVSH-user/web_auth.git
   cd web_auth
   ```

2. Соберите Docker-образ:

   ```bash
   docker build -t web_auth .
   ```

3. Запустите контейнер:

   ```bash
   docker run -d -p 8080:8080 web_auth
   ```

   Теперь приложение будет доступно по адресу `http://localhost:8080`.


## Локальная разработка

Для локальной разработки и тестирования вы можете запустить приложение вне Docker:

1. Установите зависимости:

   ```bash
   go mod download
   ```

2. Запустите приложение:

   ```bash
   go run cmd/auth/main.go
   ```

## Наполнение базы данных тестовыми данными

Для наполнения базы данных тестовыми данными используйте функцию `SeedDatabase` в `main.go`. Она создаст несколько тестовых пользователей и сообщений, чтобы упростить разработку и тестирование.
Задать кол-во моковых пользователей и кол-во сообщений для них можно в конфиге проекта.



# Документация API

### Эндпоинты

#### 1. Регистрация пользователя

**URL**: `/register`  
**Метод**: `POST`  
**Описание**: Создает нового пользователя с указанными email и паролем.

**Параметры**:

- `email` (string, обязательный): Электронная почта пользователя.
- `password` (string, обязательный): Пароль пользователя.

**Тело запроса (JSON)**:

```json
{
  "email": "user@example.com",
  "password": "securePassword123"
}
```

**Ответ**:

- Успешный ответ (200):

  ```json
  {
    "user_id": 1
  }
  ```

- Ошибка (400): Неверный формат email или другой неверный ввод.

#### 2. Авторизация пользователя

**URL**: `/login`  
**Метод**: `POST`  
**Описание**: Выполняет авторизацию пользователя по email и паролю.

**Параметры**:

- `email` (string, обязательный): Электронная почта пользователя.
- `password` (string, обязательный): Пароль пользователя.

**Тело запроса (JSON)**:

```json
{
  "email": "user@example.com",
  "password": "securePassword123"
}
```

**Ответ**:

- Успешный ответ (200): Пользователь успешно авторизован.
- Ошибка (401): Неверный email или пароль.

#### 3. Получение списка пользователей с пагинацией

**URL**: `/users`  
**Метод**: `GET`  
**Описание**: Возвращает список всех пользователей с поддержкой пагинации.

**Параметры запроса**:

- `limit` (integer, необязательный): Ограничение на количество результатов.
- `offset` (integer, необязательный): Смещение для пагинации.

**Пример запроса**:

```http
GET /users?limit=10&offset=20
```

**Ответ**:

- Успешный ответ (200):

  ```json
  [
    {
      "id": 1,
      "email": "user1@example.com",
      "created_at": "2023-10-30T10:00:00Z",
      "is_active": true
    },
    ...
  ]
  ```

#### 4. Получение информации о конкретном пользователе

**URL**: `/users/{userID}`  
**Метод**: `GET`  
**Описание**: Возвращает информацию о пользователе по его `userID`.

**Параметры пути**:

- `userID` (integer, обязательный): ID пользователя, информацию о котором нужно получить.

**Пример запроса**:

```http
GET /users/1
```

**Ответ**:

- Успешный ответ (200):

  ```json
  {
    "id": 1,
    "email": "user1@example.com",
    "created_at": "2023-10-30T10:00:00Z",
    "is_active": true
  }
  ```

- Ошибка (404): Пользователь не найден.

#### 5. Блокировка пользователя

**URL**: `/users/{userID}/block`  
**Метод**: `POST`  
**Описание**: Блокирует пользователя по его `userID`, устанавливая его статус `is_active` в `false`.

**Параметры пути**:

- `userID` (integer, обязательный): ID пользователя, которого нужно заблокировать.

**Пример запроса**:

```http
POST /users/1/block
```

**Ответ**:

- Успешный ответ (200): Пользователь успешно заблокирован.
- Ошибка (404): Пользователь не найден.

#### 6. Получение сообщений пользователя с пагинацией

**URL**: `/users/{userID}/messages`  
**Метод**: `GET`  
**Описание**: Возвращает список сообщений для указанного пользователя с поддержкой пагинации.

**Параметры пути**:

- `userID` (integer, обязательный): ID пользователя, чьи сообщения нужно получить.

**Параметры запроса**:

- `limit` (integer, необязательный): Ограничение на количество результатов.
- `offset` (integer, необязательный): Смещение для пагинации.

**Пример запроса**:

```http
GET /users/1/messages?limit=10&offset=20
```

**Ответ**:

- Успешный ответ (200):

  ```json
  [
    {
      "message_id": 1,
      "user_id": 1,
      "message_text": "Hello, world!",
      "sender_type": "user",
      "created_at": "2023-10-30T12:00:00Z"
    },
    ...
  ]
  ```
